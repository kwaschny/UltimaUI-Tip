// Copyright (c) 2014-2018 Alexander Kwaschny, kwaschny.net
(function(){"use strict";if(!window.UltimaTip){if(jQuery===undefined){throw new Error("jQuery missing for UltimaTip")}if(!jQuery.isPlainObject){throw new Error("jQuery 1.4+ required for UltimaTip")}window.UltimaTip=function(target,options){if(!(this instanceof UltimaTip)){return new UltimaTip(target,options)}target=jQuery(target).first();this._={};var self=this;this.target=target;this.bubble=null;this.message=null;this.visible=false;this.options={};this.options.current={};this.options["default"]={message:"",animations:{bubble:{show:{effect:"fadeIn",duration:400},hide:{effect:undefined,duration:undefined}}},behavior:{hover:true},css:{bubble:{className:"",directions:"bottom right",offset:{x:0,y:0},zIndex:9100},message:{className:""}},callbacks:{onTipShowing:undefined,onTipShown:undefined,onTipHiding:undefined,onTipHidden:undefined}};this._.properties={classNames:{bubble:"UltimaTip-bubble",message:"UltimaTip-message"}};this.hover=function(){this.bubble._.methods.reposition();this.bubble.show()};this.remove=function(){var tipIndex=UltimaTip.getIndex(this.target);if(tipIndex>-1){UltimaTip.collection.splice(tipIndex,1)}if(this.target instanceof jQuery){this.target.off("mouseenter",self._.methods.mouseEnter);this.target.off("mouseleave",self._.methods.mouseLeave)}if(this.bubble.dom.element instanceof jQuery){this.bubble.dom.element.remove()}};this.unhover=function(){this.bubble.hide()};this._.methods={createBubble:function(){var bubble={dom:{element:jQuery("<div></div>").hide()},hide:function(){if(jQuery.isFunction(self.options.current.callbacks.onTipHiding)){if(self.options.current.callbacks.onTipHiding(self)===false){return}}var effect=self.options.current.animations.bubble.hide.effect;if(effect===undefined){effect=self.options.current.animations.bubble.show.effect}var duration=self.options.current.animations.bubble.hide.duration;if(duration===undefined){duration=self.options.current.animations.bubble.show.duration}var hasCallback=jQuery.isFunction(self.options.current.callbacks.onTipHidden);switch(effect){case"fadeIn":case"fadeOut":this.dom.element.stop(true,true).fadeOut(duration,function(){self.visible=false;if(hasCallback){self.options.current.callbacks.onTipHidden(self)}});break;default:this.dom.element.hide();self.visible=false;if(hasCallback){self.options.current.callbacks.onTipHidden(self)}break}},show:function(){if(jQuery.isFunction(self.options.current.callbacks.onTipShowing)){if(self.options.current.callbacks.onTipShowing(self)===false){return}}var hasCallback=jQuery.isFunction(self.options.current.callbacks.onTipShown);switch(self.options.current.animations.bubble.show.effect){case"fadeIn":case"fadeOut":this.dom.element.stop(true,true).fadeIn(self.options.current.animations.bubble.show.duration,function(){self.visible=true;if(hasCallback){self.options.current.callbacks.onTipShown(self)}});break;default:this.dom.element.show();self.visible=true;if(hasCallback){self.options.current.callbacks.onTipShown(self)}break}},_:{methods:{reposition:function(){var pos=self.target.offset();if(pos===undefined){return}var target={height:self.target.outerHeight(),left:pos.left,top:pos.top,width:self.target.outerWidth()};var tip={height:self.bubble.dom.element.outerHeight(),width:self.bubble.dom.element.outerWidth()};var directions=self.options.current.css.bubble.directions.split(" ");var left,top;for(var i=0;i<directions.length;i++){switch(directions[i].toLowerCase()){case"bottom":top=target.top+target.height+self.options.current.css.bubble.offset.y;break;case"center":left=Math.max(0,target.left+target.width/2-tip.width/2+self.options.current.css.bubble.offset.x);break;case"left":left=target.left-tip.width-self.options.current.css.bubble.offset.x;break;case"middle":top=target.top+target.height/2-tip.height/2+self.options.current.css.bubble.offset.y;break;case"right":left=target.left+target.width+self.options.current.css.bubble.offset.x;break;case"top":top=target.top-tip.height-self.options.current.css.bubble.offset.y;break}}if(left===undefined){left=Math.max(0,target.left+target.width/2-tip.width/2+self.options.current.css.bubble.offset.x)}if(top===undefined){top=target.top+target.height/2-tip.height/2+self.options.current.css.bubble.offset.y}self.bubble.dom.element.css({left:left,top:top})}}}};bubble.dom.element.addClass(self._.properties.classNames.bubble);bubble.dom.element.addClass(self.options.current.css.bubble.className);var cssAttr={};if(!self.options.current.css.bubble.className){cssAttr.backgroundColor="#FFFFFF";cssAttr.border="1px solid #808080";cssAttr.boxShadow="2px 2px 4px #808080";cssAttr.color="#808080";cssAttr.fontSize="80%";cssAttr.padding="4px"}jQuery.extend(true,cssAttr,self.options.current.css.bubble);jQuery.extend(true,cssAttr,{position:"absolute",zIndex:self.options.current.css.bubble.zIndex});bubble.dom.element.css(cssAttr);if(self.options.current.behavior.hover===true){self.target.on("mouseenter touchstart",self._.methods.mouseEnter);self.target.on("mouseleave touchend",self._.methods.mouseLeave)}return bubble},createMessage:function(){var message={dom:{element:jQuery("<div></div>")},hide:function(){this.dom.element.hide()},set:function(content){this.dom.element.html(content)},show:function(){this.dom.element.show()}};message.dom.element.addClass(self._.properties.classNames.message);message.dom.element.addClass(self.options.current.css.message.className);message.dom.element.css(self.options.current.css.message);return message},mouseEnter:function(){self.bubble._.methods.reposition();self.bubble.show()},mouseLeave:function(){self.bubble.hide()},mergeOptions:function(options1,options2){self._.methods.translateOptions(options2);var result={};jQuery.extend(true,result,options1);jQuery.extend(true,result,options2);return result},translateOptions:function(options){var buffer,length,i,result,ref;for(var key in options){if(!options.hasOwnProperty(key)){continue}if(key.indexOf("->")!==0){continue}buffer=key.replace("->","");buffer=buffer.split(".");length=buffer.length;result={};ref=result;for(i=0;i<length-1;i++){ref[buffer[i]]={};ref=ref[buffer[i]]}ref[buffer[length-1]]=options[key];delete options[key];jQuery.extend(true,options,result)}return options}};this.options.current=this._.methods.mergeOptions(this.options["default"],UltimaTip.options);this.options.current=this._.methods.mergeOptions(this.options.current,options);this.bubble=this._.methods.createBubble();this.message=this._.methods.createMessage();this.message.set(this.options.current.message);this.bubble.dom.element.append(this.message.dom.element);jQuery("body").append(this.bubble.dom.element);UltimaTip.collection.push(this)};UltimaTip.collection=[];UltimaTip.options={};UltimaTip._={methods:{}};UltimaTip._.methods.isOptions=function(data){if(!jQuery.isPlainObject(data)){return false}if(data.message&&!jQuery.isPlainObject(data.message)||data.css&&jQuery.isPlainObject(data.css)||data.callbacks&&jQuery.isPlainObject(data.callbacks)){return true}for(var key in data){if(!data.hasOwnProperty(key)){continue}if(/^->[a-z]+(\.[a-z]+)?/.test(key)){return true}}return false};UltimaTip.clear=function(){var count=0;var tip;while(true){tip=UltimaTip.get(0);if(tip!==null){count+=1;tip.remove()}else{break}}return count};UltimaTip.get=function(target){if(typeof target==="number"){if(UltimaTip.collection.length>target){return UltimaTip.collection[target]}}else{var tipIndex=UltimaTip.getIndex(target);if(tipIndex>-1){return UltimaTip.collection[tipIndex]}}return null};UltimaTip.getIndex=function(target){if(target instanceof jQuery){target=target[0]}var i=0,len=UltimaTip.collection.length;for(i;i<len;i++){if(target===UltimaTip.collection[i].target[0]){return i}}return-1};UltimaTip.remove=function(target){var count=0;var tip=UltimaTip.get(target);while(tip!==null){tip.remove();count+=1;tip=UltimaTip.get(target)}return count};jQuery.UltimaTip={options:{}};jQuery.UltimaTip.hover=function(target,message,options){if(target===undefined){return null}if(arguments.length===2){if(UltimaTip._.methods.isOptions(message)){options=message;message=undefined}}var mergedOptions={};jQuery.extend(true,mergedOptions,jQuery.UltimaTip.options);jQuery.extend(true,mergedOptions,options);if(message){mergedOptions.message=message}var tip=UltimaTip.get(target);if(tip===null){tip=new UltimaTip(target,mergedOptions)}tip.hover();return tip};jQuery.UltimaTip.unhover=function(target){return UltimaTip.remove(target)};jQuery.fn.UltimaTip=function(message,options){if(message===undefined||message===""){return UltimaTip.remove(this)}if(arguments.length===1){if(UltimaTip._.methods.isOptions(message)){options=message;message=undefined}}var mergedOptions={};jQuery.extend(true,mergedOptions,jQuery.UltimaTip.options);jQuery.extend(true,mergedOptions,options);if(message){mergedOptions.message=message}this.each(function(){if(UltimaTip.get(this)===null){new UltimaTip(this,mergedOptions)}});return this};jQuery.fn.hoverTip=function(){this.each(function(){var tip=UltimaTip.get(this);if(tip!==null){tip.hover()}});return this};jQuery.fn.unhoverTip=function(){this.each(function(){var tip=UltimaTip.get(this);if(tip!==null){tip.unhover()}});return this};jQuery.fn.toggleHoverTip=function(){this.each(function(){var tip=UltimaTip.get(this);if(tip!==null){if(tip.visible){tip.unhover()}else{tip.hover()}}});return this};UltimaTip.version="0.4.6"}})();